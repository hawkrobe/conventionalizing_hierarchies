
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="/favicon.ico">

    <title>Experiment</title>

    <!-- Bootstrap core CSS -->
    <link href="/lib/css/bootstrap.min.css" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

    <!-- Custom styles for this template -->
    <link href="theme.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body role="document">

    <div class="container theme-showcase" role="main">

      </br>
      <div class="progress">
        <div class="progress-bar" role="progressbar" aria-valuenow="5"
	     aria-valuemin="0" aria-valuemax="100" style="width: 5%;">
	  <span class="sr-only">5% Complete</span>
	</div>
      </div>
      
      <div class="page-header">
        <h1>Instructions</h1>
      </div>

      <div class="well" style="width:800px; margin: 0 auto">

	<h2><center>Fill the customer's order!</center>  </h2>

	<p>
	  In this experiment you will play a fun communication game
	  with another turker! Imagine that you work together in a
	  warehouse for the Shape Company and your goal is to fill
	  orders for customers. The company only sells these eight
	  objects:
	</p>

	<p>
	  <center>
	    <img src="images/all_objs.png" alt="Example objects"
		 style="width:642px; height:300px">
	  </center>
	</p>

	<p>
	  Today, only four of these objects will appear in customers'
	  orders. 
	</p>

	<p>
	  There are two jobs, which you and your partner will take
	  turns doing. The <b> Speaker </b> sees which objects are in
	  the customer's order and must communicate this information
	  to the <b> Listener </b> who packs the objects. In each
	  round, you will see a new customer's order. The objects in
	  the order will be outlined on the Speaker's screen only.
	</p>
	
	<p>
	  Sometimes the orders are for one object only. In the first
	  example below, the only object in the order is the circle in
	  the upper-left corner of the Speaker's display. Other times
	  there are two objects in the order! In the second example,
	  the order includes both of the red squares.
	</p>

	<p>
	  <center>
	    <img src="images/cartoon2.png" alt="Task cartoon"
		 style="width:600px; height:616px">
	  </center>
	</p>
	
	<!-- <p> -->
	<!--   <center> -->
	<!--     <img src="images/screenshot_objs.png" alt="Example objects" -->
	<!-- 	 style="width:300px; height:300px"> -->
	<!--   </center> -->
	<!-- </p> -->

	<p>
	  The goal of the Speaker is to send a message so that the
	  Listener can correctly fill the order. If you are the
	  Listener, you will first need to wait until the Speaker has
	  sent their message before being able to click on the object
	  (or two objects) you think they're telling you about. You'll both
	  get <b> a bonus of $0.03 when an order is correctly
	  filled</b> (i.e. when the Listener selects exactly the
	  objects in the order), so pay attention!
	</p>
	
	<p>
	  What makes this game more interesting and challenging is the
	  content of your messages: instead of using words you already
	  know, you get to make up a language together! You will see a
	  menu containing 9 messages: to send one of the messages, the
	  Speaker can click and drag it into the grey 'dropzone'
	  below.
	</p>
	
	<p>
	  <center>
	    <img src="images/screenshot_labels.png" alt="Example labels"
		 style="width:300px; height:300px">
	  </center>
	</p>
	
	<p>
	  Once the Listener clicks on the one or two objects they
	  believe are in the order, they must click 'Done' and both
	  players will be given feedback. The Speaker will see what
	  the Listener clicked, and the Listener will see the objects
	  that were actually in the customer's order. Then you will
	  see a new order and <b>switch roles</b>, so the Listener
	  will become the Speaker and vice versa. There are a total
	  of <b>72 orders</b>. After the final round you will answer a
	  few more questions and be on your way.
	</p>

	<p>
	  A few final notes: First, since you are playing with
	  another player, you may see this screen before the game
	  begins:
	<p>
	  <center><img src="images/waitScreen.png" alt="initial matcher's board"
		       style="width:700px;height:150px">
	  </center>
	</p>
	Just hold tight. Another player should join the game within
	the next few minutes. If you're in the waiting room 5 minutes
	without another player joining, please return the HIT and try
	again later!
	</p>

	<p>
	  Second, please be respectful of the worker you're playing
	  with: their bonus payment depends on your performance as
	  well, so please pay close attention and try to be as
	  responsive and helpful as possible.
	</p>

	<p>
	  Third, the arrangement of the objects on your screen are
	  different for you and your partner, and change every round,
	  so you can't develop a language based on how the objects are
	  arranged (e.g. a message meaning 'the upper-left
	  object'). 
	</p>
	
	<p>
	  Finally, please DO NOT refresh the page at any point once
	  you start the game (including the waiting page). If you
	  refresh, you will not be able to rejoin the game you were in
	  and you may not be able to submit the HIT. <br> Thank you!
	</p>

	<h3>
	  Please fill out this short quiz below before getting started.
	  Good luck and have fun!
	</h3>
	
      </div>

      <div class="page-header">
        <h3>Comprehension Quiz</h3>
      </div>

      <div class="well" style="width:800px; margin: 0 auto">
	
	<br>
	The <b>Speaker</b> can click on objects to fill the order.
	<br>
	<input type="radio" name="dgoal" value="no"> True
	<br>
	<input type="radio" name="dgoal" value="yes"> False
	<br>


	<br>
	The <b>Listener</b> wants to click on the object or objects that the speaker is
	telling them about.
	<br>
	<input type="radio" name="mgoal" value="yes"> True
	<br>
	<input type="radio" name="mgoal" value="no"> False
	<br>

	<br>
	Only the Speaker can send messages.
	<br>
	<input type="radio" name="message" value="yes"> True
	<br>
	<input type="radio" name="message" value="no"> False
	<br>

	<br>
	There are a total of 200 rounds.
	<br>
	<input type="radio" name="comp" value="no"> True
	<br>
	<input type="radio" name="comp" value="yes"> False
	<br>

	<br>
	The locations of the objects are the same for the Speaker and the Listener.
	<br>
	<input type="radio" name="location" value="yes"> False
	<br>
	<input type="radio" name="location" value="no"> True
	<br>

	<br>
	Have you participated in this study before?
        <br>
        <input type="radio" name="completed" value="no"> Yes
        <br>
        <input type="radio" name="completed" value="yes"> No
        <br>

	<br>
	<input id="quiz_submit" type="submit" value="Submit">
	<br>
	<br>
	<div class="error" style="display:none"> Ooops! Looks like you made a mistake. You have one more try. </div>
      </div> <!-- /container -->
    </div>

    <script type="text/javascript">
      $('html,body').scrollTop(0);
      var urlParams;
	var match,
	      pl     = /\+/g,  // Regex for replacing addition symbol with a space
	      search = /([^&=]+)=?([^&]*)/g,
	      decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
	      query  = location.search.substring(1);

      urlParams = {};
      while (match = search.exec(query))
      urlParams[decode(match[1])] = decode(match[2]);

      console.log(urlParams)

      var counter = 0;
      document.getElementById("quiz_submit").onclick = function () {
        var ans1 = $('input[name="dgoal"]:checked').val();
        var ans2 = $('input[name="mgoal"]:checked').val();
        var ans3 = $('input[name="message"]:checked').val();
        var ans4 = $('input[name="comp"]:checked').val();
        var ans5 = $('input[name="location"]:checked').val();
        var ans6 = $('input[name="completed"]:checked').val();

        if(ans1 == "yes" && ans2 == "yes" && ans3 == "yes" && 
           ans4 == "yes" && ans5 == "yes" && ans6 == "yes") { 
           var workerId = urlParams.workerId;
           var assignmentId = urlParams.assignmentId;
           var hitId = urlParams.hitId;
           var turkSubmitTo = urlParams.turkSubmitTo;
           location.replace("./pass.html?workerId=" + workerId
                            + "&assignmentId=" + assignmentId
                            + "&hitId=" + hitId + "&turkSubmitTo=" + turkSubmitTo);
        } else if(counter == 3) {
          location.replace("./fail.html");
        } else {
          $('.error').show()
          counter += 1;
        }
      };
    </script>

    <script src="./validate-form.js"></script>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

    <script src="/lib/js/bootstrap.min.js"></script>
  </body>
</html>
